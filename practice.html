<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quran Topics Practice</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="bg-light py-4">

  <div class="container">
    <h2 class="text-center mb-4">Quran Topics & Details</h2>
    <div id="english_subjects"></div>
  </div>

  <div class="container" id="practive_div_btn">
<!-- <button class="btn">1</button> -->
  </div>
<script>
const english_subjects = document.getElementById("english_subjects");
var practive_div_btn = document.getElementById("practive_div_btn");

var headers = {
  "Authorization": "Bearer b1e2f3a4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2",
  "Content-Type": "application/json"
};

var valus = 1;
var topica;
  var topic_detail;

function Paginvalue(e) {
  valus = e;
  topica = fetch(`https://subjectsofalquran.com/api/topics?page=${valus}`, { method: "GET", headers });


  topica.then((e) => e.json())
    .then((res) => {
      english_subjects.innerHTML = ""; // clear old data
      topicRender(res);
    });
}


function topicRender(data) {
  data.data.forEach((t) => {
    // console.log(t);
    
   topic_detail= fetch(`https://subjectsofalquran.com/api/topicdetails/topic/${t.id}`, { method: "GET", headers });

    
    english_subjects.innerHTML += `
    <div class="accordion accordion-flush" id="accordionFlushExample">
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
${t.topicname}
      </button>
    </h2>
    <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
      <div class="accordion-body">
        ${topic_detail.then((e=> e.json()))
        .then((res)=>{
         res.data.length > 0 ? 
          res.data.forEach((e)=>{
            console.log(e.topicdetail);
            `<p>${e.topicdetail}</p>`
            
          })
          :
           `<p>data not available</p>` 

        })
        }
        </div>
    </div>
  </div>

  
</div>

    `;
  });
}


function topic(a) {
  Paginvalue(valus); 
  
 
}


topic(function (data) {
  for (let index = 1; index <= data.last_page; index++) {
    practive_div_btn.innerHTML += `
      <button class="btn btn-outline-primary m-1 btn-sm" onclick="Paginvalue(${index})">${index}</button>
    `;
  }
});
    
    // yahan pr funtion sa value log krwane ha 
      // setTimeout(() => {
      //   var topic_detail = fetch("https://subjectsofalquran.com/api/topicdetails", { method: "GET", headers });
      //   topic_detail.then((e) => e.json())
      //               .then((res) => {
      //                 console.log("topic_detail", res);
      //               });
      // }, 1000);










// fetch("https://subjectsofalquran.com/api/topics", { method: "GET", headers })
//   .then(res => res.json())
//   .then(async (topicRes) => {
//     const topics = topicRes.data;

//     for (let topic of topics) {
//       // Fetch topic details for this topic
//       const detailRes = await fetch(`https://subjectsofalquran.com/api/topicdetails/topic/${topic.id}`, {
//         method: "GET",
//         headers
//       });

//       if (!detailRes.ok) continue;

//       const detailJson = await detailRes.json();
//       console.log(detailJson.data[0].topicdetail);
      
//       const details = detailJson.data;

//       // Merge all topicdetail strings together (safe fallback)
//       const joinedDetails = details.map(d => d.topicdetail)

//       const accordionHTML = `
//         <div class="accordion mb-3" id="accordion-${topic.id}">
//           <div class="accordion-item">
//             <h2 class="accordion-header" id="heading-${topic.id}">
//               <button class="accordion-button collapsed" type="button"
//                 data-bs-toggle="collapse"
//                 data-bs-target="#collapse-${topic.id}"
//                 aria-expanded="false"
//                 aria-controls="collapse-${topic.id}">
//                 ${topic.topicname}
//               </button>
//             </h2>
//             <div id="collapse-${topic.id}" class="accordion-collapse collapse"
//               aria-labelledby="heading-${topic.id}" data-bs-parent="#accordion-${topic.id}">
//               <div class="accordion-body">
//                 ${
//                   joinedDetails
//                     ? `<p>${joinedDetails}</p>`
//                     : `<p class="text-muted">No details available.</p>`
//                 }
//               </div>
//             </div>
//           </div>
//         </div>
//       `;

//       english_subjects.innerHTML += accordionHTML;
//     }
//   })
//   .catch(err => console.error("Error:", err));


</script>

</body>
</html>
